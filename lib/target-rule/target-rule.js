!function($,a,b){var c=function(a){$(a).xproselect2({placeholder:XproRules.search,ajax:{url:ajaxurl,dataType:"json",method:"post",delay:250,data:function(a){return{q:a.term,page:a.page,action:"xpro_theme_builder_get_posts_by_query",nonce:XproRules.ajax_nonce}},processResults:function(a){return{results:a}},cache:!0},minimumInputLength:2,language:XproRules.xpro_lang})},d=function(a){var b=a.find(".xpro-target_rule-input");b.val();var c=[];a.find(".xpro-target-rule-condition").each(function(h){var a=$(this),b={},e=a.find("select.target_rule-condition"),f=a.find("select.target_rule-specific-page"),d=e.val(),g=f.val();""!=d&&(b={type:d,specific:g},c.push(b))});var d=JSON.stringify(c);b.val(d)},e=function(a){type=a.closest(".xpro-target-rule-wrapper").attr("data-type"),rules=a.find(".xpro-target-rule-condition"),show_close=!1,"display"==type?rules.length>1&&(show_close=!0):show_close=!0,rules.each(function(){show_close?jQuery(this).find(".target_rule-condition-delete").removeClass("xpro-hidden"):jQuery(this).find(".target_rule-condition-delete").addClass("xpro-hidden")})},f=function(e,f){var g=$(".xpro-target-rule-display-on-wrap"),c=$(".xpro-target-rule-exclude-on-wrap"),a=c.closest("tr"),b=g.find(".target_rule-add-exclusion-rule"),d=c.find(".xpro-target-rule-condition");!0==f?(a.addClass("xpro-hidden"),b.removeClass("xpro-hidden")):!0==e?(a.removeClass("xpro-hidden"),b.addClass("xpro-hidden")):1==d.length&&""==$(d[0]).find("select.target_rule-condition").val()?(a.addClass("xpro-hidden"),b.removeClass("xpro-hidden")):(a.removeClass("xpro-hidden"),b.addClass("xpro-hidden"))};$(document).ready(function($){jQuery(".xpro-target-rule-condition").each(function(){var a=$(this),b=a.find("select.target_rule-condition").val(),c=a.next(".target_rule-specific-page-wrap");"specifics"==b&&c.slideDown(300)}),jQuery("select.target-rule-select2").each(function(b,a){c(a)}),jQuery(".xpro-target-rule-selector-wrapper").each(function(){e(jQuery(this))}),f(),jQuery(document).on("change",".xpro-target-rule-condition select.target_rule-condition",function(e){var a=jQuery(this),b=a.val(),c=a.closest(".xpro-target-rule-wrapper");"specifics"==b?a.closest(".xpro-target-rule-condition").next(".target_rule-specific-page-wrap").slideDown(300):a.closest(".xpro-target-rule-condition").next(".target_rule-specific-page-wrap").slideUp(300),d(c)}),jQuery(".xpro-target-rule-selector-wrapper").on("change",".target-rule-select2",function(a){d(jQuery(this).closest(".xpro-target-rule-wrapper"))}),jQuery(".xpro-target-rule-selector-wrapper").on("click",".target_rule-add-rule-wrap a",function(d){d.preventDefault(),d.stopPropagation();var a=jQuery(this),f=parseInt(a.attr("data-rule-id"))+1,b=a.attr("data-rule-type"),g=a.closest(".xpro-target-rule-selector-wrapper").find(".target_rule-builder-wrap"),h=wp.template("xpro-target-rule-"+b+"-condition"),i=a.closest(".xpro-target-rule-wrapper");g.append(h({id:f,type:b})),c(".xpro-target-rule-"+b+"-on .target-rule-select2"),a.attr("data-rule-id",f),e(i)}),jQuery(".xpro-target-rule-selector-wrapper").on("click",".target_rule-condition-delete",function(g){var b=jQuery(this),c=b.closest(".xpro-target-rule-condition"),a=b.closest(".xpro-target-rule-wrapper");cnt=0,data_type=a.attr("data-type"),optionVal=b.siblings(".target_rule-condition-wrap").children(".target_rule-condition").val(),"exclude"==data_type&&1===a.find(".target_rule-condition").length?(a.find(".target_rule-condition").val(""),a.find(".target_rule-specific-page").val(""),a.find(".target_rule-condition").trigger("change"),f(!1,!0)):(b.parent(".xpro-target-rule-condition").next(".target_rule-specific-page-wrap").remove(),c.remove()),a.find(".xpro-target-rule-condition").each(function(b){var a=jQuery(this),c=a.attr("data-rule"),d=a.find(".target_rule-condition"),e=(a.find(".target_rule-specific-page"),d.attr("name"));a.attr("data-rule",b),d.attr("name",e.replace("["+c+"]","["+b+"]")),a.removeClass("xpro-target-rule-"+c).addClass("xpro-target-rule-"+b),cnt=b}),a.find(".target_rule-add-rule-wrap a").attr("data-rule-id",cnt),e(a),d(a)}),jQuery(".xpro-target-rule-selector-wrapper").on("click",".target_rule-add-exclusion-rule a",function(a){a.preventDefault(),a.stopPropagation(),f(!0)})})}(jQuery,window)